{"version":1,"kind":"Notebook","sha256":"ae639facb30ec717d62a4f2bd239a90b694ca5e71cded7f78d564cc961d294bc","slug":"colabs.sp500-stock-eda","location":"/colabs/sp500_stock_eda.ipynb","dependencies":[],"frontmatter":{"title":"S&P 500 Investment Strategy Analysis","content_includes_title":true,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"subject":"Notes from JP","keywords":["colabs","machine-learning","python","book review"],"thumbnail":"/7e2db436150c38a00650f96925aa5581.svg","exports":[{"format":"ipynb","filename":"sp500_stock_eda.ipynb","url":"/sp500_stock_eda-19a2d3570140d9010c43c3f5c5fc5ab5.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{"colab_type":"text","id":"view-in-github"},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"link","url":"https://colab.research.google.com/github/osjayaprakash/notes/blob/main/colabs/sp500_stock_eda.ipynb","children":[{"type":"image","url":"/7e2db436150c38a00650f96925aa5581.svg","alt":"Open In Colab","key":"YJHBaFD6n0","urlSource":"https://colab.research.google.com/assets/colab-badge.svg"}],"urlSource":"https://colab.research.google.com/github/osjayaprakash/notes/blob/main/colabs/sp500_stock_eda.ipynb","key":"t7IVtXNAFB"}],"key":"gqlalJ0Ddz"}],"identifier":"view-in-github","label":"view-in-github","html_id":"view-in-github","key":"ixbw2WdvMe"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"S&P 500 Investment Strategy Analysis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jUqW3HDnEK"}],"identifier":"s-p-500-investment-strategy-analysis","label":"S&P 500 Investment Strategy Analysis","html_id":"s-p-500-investment-strategy-analysis","implicit":true,"key":"xgGcBRjGKF"}],"key":"WWFuA4B3g8"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# !pip3 install kagglehub pandas matplotlib","key":"iAbkwbBhRh"},{"type":"output","id":"d7QZm-9mXH6Da4ujXo4w2","data":[],"key":"lFNcpz96CY"}],"key":"UV8anaPxLB"},{"type":"block","kind":"notebook-code","data":{"id":"f9spmgbLZkAx"},"children":[{"type":"code","lang":"python","executable":true,"value":"import pandas as pd\nimport matplotlib.pyplot as plt\nimport warnings\nwarnings.filterwarnings('ignore')","identifier":"f9spmgblzkax-code","enumerator":"1","html_id":"f9spmgblzkax-code","key":"YPkq0kj7gQ"},{"type":"output","id":"zjJ3DlZ9_NLALlduZUDLz","data":[],"identifier":"f9spmgblzkax-output","html_id":"f9spmgblzkax-output","key":"Z9TGMyvLQB"}],"identifier":"f9spmgblzkax","label":"f9spmgbLZkAx","html_id":"f9spmgblzkax","key":"cOLtXLy1Fa"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Download SP500 stock for last 30 years","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"u6SxWt7SyA"}],"identifier":"download-sp500-stock-for-last-30-years","label":"Download SP500 stock for last 30 years","html_id":"download-sp500-stock-for-last-30-years","implicit":true,"key":"OVcMGqv9yw"}],"key":"EMXw4EXQcj"},{"type":"block","kind":"notebook-code","data":{"colab":{"base_uri":"https://localhost:8080/"},"id":"RETp4pOkZs8h","outputId":"04d1a00d-a9e2-4dd2-f890-7b9b42f6f221"},"children":[{"type":"code","lang":"python","executable":true,"value":"import kagglehub\n\npath = kagglehub.dataset_download(\"asimislam/30-yrs-stock-market-data\")\nprint(\"Path to dataset files:\", path)","identifier":"retp4pokzs8h-code","enumerator":"2","html_id":"retp4pokzs8h-code","key":"bOsn7J0E8g"},{"type":"output","id":"IsR_nwcxShUTipl5dqChI","data":[{"name":"stdout","output_type":"stream","text":"Path to dataset files: /Users/jp/.cache/kagglehub/datasets/asimislam/30-yrs-stock-market-data/versions/3\n"}],"identifier":"retp4pokzs8h-output","html_id":"retp4pokzs8h-output","key":"pj1XwEwIUJ"}],"identifier":"retp4pokzs8h","label":"RETp4pOkZs8h","html_id":"retp4pokzs8h","key":"CdIcjs50gI"},{"type":"block","kind":"notebook-code","data":{"colab":{"base_uri":"https://localhost:8080/"},"id":"wtpcRWIUap6j","outputId":"8258d785-3962-4d68-bb65-e60fd33c627c"},"children":[{"type":"code","lang":"python","executable":true,"value":"!ls \"{path}\"","identifier":"wtpcrwiuap6j-code","enumerator":"3","html_id":"wtpcrwiuap6j-code","key":"yfpLN2TWfB"},{"type":"output","id":"sAKSsoFPvIp-dkXrpCZs3","data":[{"name":"stdout","output_type":"stream","text":"30_yr_stock_market_data.csv 30_yr_stock_market_info.csv\n"}],"identifier":"wtpcrwiuap6j-output","html_id":"wtpcrwiuap6j-output","key":"LyRNwNLDA0"}],"identifier":"wtpcrwiuap6j","label":"wtpcRWIUap6j","html_id":"wtpcrwiuap6j","key":"DmygNgzraf"},{"type":"block","kind":"notebook-code","data":{"id":"J9KSQC2aasdb"},"children":[{"type":"code","lang":"python","executable":true,"value":"df1 = pd.read_csv(f\"{path}/30_yr_stock_market_data.csv\")","identifier":"j9ksqc2aasdb-code","enumerator":"4","html_id":"j9ksqc2aasdb-code","key":"pW0LqyIbEh"},{"type":"output","id":"9yEJlymH93MjUinXL_RtX","data":[],"identifier":"j9ksqc2aasdb-output","html_id":"j9ksqc2aasdb-output","key":"y22jvtQYXZ"}],"identifier":"j9ksqc2aasdb","label":"J9KSQC2aasdb","html_id":"j9ksqc2aasdb","key":"V9i1A2Fx52"},{"type":"block","kind":"notebook-code","data":{"colab":{"base_uri":"https://localhost:8080/"},"id":"vhMXBb6Pa13S","outputId":"a0da16ca-bab6-411f-a82f-cf7eec36c65f"},"children":[{"type":"code","lang":"python","executable":true,"value":"df1.columns","identifier":"vhmxbb6pa13s-code","enumerator":"5","html_id":"vhmxbb6pa13s-code","key":"wfPwytJ2NK"},{"type":"output","id":"KMRokRUYvzWS9eK6z60rb","data":[{"output_type":"execute_result","execution_count":26,"metadata":{},"data":{"text/plain":{"content":"Index(['Date', 'Dow Jones (^DJI)', 'Nasdaq (^IXIC)', 'S&P500 (^GSPC)',\n       'NYSE Composite (^NYA)', 'Russell 2000 (^RUT)',\n       'CBOE Volitility (^VIX)', 'DAX Index (^GDAXI)', 'FTSE 100 (^FTSE)',\n       'Hang Seng Index (^HSI)', 'Cocoa (CC=F)', 'Coffee (KC=F)',\n       'Corn (ZC=F)', 'Cotton (CT=F)', 'Live Cattle (LE=F)',\n       'Orange Juice (OJ=F)', 'Soybeans (ZS=F)', 'Sugar (SB=F)',\n       'Wheat (ZW=F)', 'Ethanol (EH=F)', 'Heating Oil (HO=F)',\n       'Natural Gas (NG=F)', 'Crude Oil-Brent (BZ=F)', 'Crude Oil-WTI (CL=F)',\n       'Copper (HG=F)', 'Gold (GC=F)', 'Palladium (PA=F)', 'Platinum (PL=F)',\n       'Silver (SI=F)', 'Treasury Yield 5 Years (^FVX)',\n       'Treasury Bill 13 Week (^IRX)', 'Treasury Yield 10 Years (^TNX)',\n       'Treasury Yield 30 Years (^TYX)'],\n      dtype='object')","content_type":"text/plain"}}}],"identifier":"vhmxbb6pa13s-output","html_id":"vhmxbb6pa13s-output","key":"scvzHNx70i"}],"identifier":"vhmxbb6pa13s","label":"vhMXBb6Pa13S","html_id":"vhmxbb6pa13s","key":"VmUW7BJ2ZF"},{"type":"block","kind":"notebook-code","data":{"colab":{"base_uri":"https://localhost:8080/","height":432},"id":"7ULhOg5-qj4v","outputId":"7f004070-efda-4576-9872-b789e3ca0ba1"},"children":[{"type":"code","lang":"python","executable":true,"value":"df1.head(5)","identifier":"7ulhog5-qj4v-code","enumerator":"6","html_id":"id-7ulhog5-qj4v-code","key":"nKDA7H2sTo"},{"type":"output","id":"FRksCzNFLzCV_UBuqCdf6","data":[{"output_type":"execute_result","execution_count":27,"metadata":{},"data":{"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Date</th>\n      <th>Dow Jones (^DJI)</th>\n      <th>Nasdaq (^IXIC)</th>\n      <th>S&amp;P500 (^GSPC)</th>\n      <th>NYSE Composite (^NYA)</th>\n      <th>Russell 2000 (^RUT)</th>\n      <th>CBOE Volitility (^VIX)</th>\n      <th>DAX Index (^GDAXI)</th>\n      <th>FTSE 100 (^FTSE)</th>\n      <th>Hang Seng Index (^HSI)</th>\n      <th>...</th>\n      <th>Crude Oil-WTI (CL=F)</th>\n      <th>Copper (HG=F)</th>\n      <th>Gold (GC=F)</th>\n      <th>Palladium (PA=F)</th>\n      <th>Platinum (PL=F)</th>\n      <th>Silver (SI=F)</th>\n      <th>Treasury Yield 5 Years (^FVX)</th>\n      <th>Treasury Bill 13 Week (^IRX)</th>\n      <th>Treasury Yield 10 Years (^TNX)</th>\n      <th>Treasury Yield 30 Years (^TYX)</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1993-11-29</td>\n      <td>3677.800049</td>\n      <td>751.539978</td>\n      <td>461.899994</td>\n      <td>2697.040039</td>\n      <td>250.139999</td>\n      <td>14.12</td>\n      <td>2052.090088</td>\n      <td>3135.800049</td>\n      <td>9012.799805</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>5.075</td>\n      <td>3.11</td>\n      <td>5.732</td>\n      <td>6.226</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1993-11-30</td>\n      <td>3683.949951</td>\n      <td>754.390015</td>\n      <td>461.790009</td>\n      <td>2694.080078</td>\n      <td>250.410004</td>\n      <td>13.76</td>\n      <td>2052.919922</td>\n      <td>3166.899902</td>\n      <td>9125.200195</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>5.146</td>\n      <td>3.14</td>\n      <td>5.795</td>\n      <td>6.286</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>1993-12-01</td>\n      <td>3697.080078</td>\n      <td>763.809998</td>\n      <td>461.890015</td>\n      <td>2699.159912</td>\n      <td>252.610001</td>\n      <td>13.83</td>\n      <td>2089.770020</td>\n      <td>3233.199951</td>\n      <td>9254.000000</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>5.132</td>\n      <td>3.11</td>\n      <td>5.783</td>\n      <td>6.268</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>1993-12-02</td>\n      <td>3702.110107</td>\n      <td>766.729980</td>\n      <td>463.109985</td>\n      <td>2705.179932</td>\n      <td>252.910004</td>\n      <td>13.51</td>\n      <td>2099.760010</td>\n      <td>3223.899902</td>\n      <td>9238.200195</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>5.146</td>\n      <td>3.11</td>\n      <td>5.778</td>\n      <td>6.263</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>1993-12-03</td>\n      <td>3704.070068</td>\n      <td>772.219971</td>\n      <td>464.890015</td>\n      <td>2714.699951</td>\n      <td>253.860001</td>\n      <td>12.69</td>\n      <td>2128.300049</td>\n      <td>3234.199951</td>\n      <td>9294.400391</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>5.175</td>\n      <td>3.11</td>\n      <td>5.783</td>\n      <td>6.258</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows × 33 columns</p>\n</div>","content_type":"text/html"},"text/plain":{"content":"         Date  Dow Jones (^DJI)  Nasdaq (^IXIC)  S&P500 (^GSPC)  \\\n0  1993-11-29       3677.800049      751.539978      461.899994   \n1  1993-11-30       3683.949951      754.390015      461.790009   \n2  1993-12-01       3697.080078      763.809998      461.890015   \n3  1993-12-02       3702.110107      766.729980      463.109985   \n4  1993-12-03       3704.070068      772.219971      464.890015   \n\n   NYSE Composite (^NYA)  Russell 2000 (^RUT)  CBOE Volitility (^VIX)  \\\n0            2697.040039           250.139999                   14.12   \n1            2694.080078           250.410004                   13.76   \n2            2699.159912           252.610001                   13.83   \n3            2705.179932           252.910004                   13.51   \n4            2714.699951           253.860001                   12.69   \n\n   DAX Index (^GDAXI)  FTSE 100 (^FTSE)  Hang Seng Index (^HSI)  ...  \\\n0         2052.090088       3135.800049             9012.799805  ...   \n1         2052.919922       3166.899902             9125.200195  ...   \n2         2089.770020       3233.199951             9254.000000  ...   \n3         2099.760010       3223.899902             9238.200195  ...   \n4         2128.300049       3234.199951             9294.400391  ...   \n\n   Crude Oil-WTI (CL=F)  Copper (HG=F)  Gold (GC=F)  Palladium (PA=F)  \\\n0                   NaN            NaN          NaN               NaN   \n1                   NaN            NaN          NaN               NaN   \n2                   NaN            NaN          NaN               NaN   \n3                   NaN            NaN          NaN               NaN   \n4                   NaN            NaN          NaN               NaN   \n\n   Platinum (PL=F)  Silver (SI=F)  Treasury Yield 5 Years (^FVX)  \\\n0              NaN            NaN                          5.075   \n1              NaN            NaN                          5.146   \n2              NaN            NaN                          5.132   \n3              NaN            NaN                          5.146   \n4              NaN            NaN                          5.175   \n\n   Treasury Bill 13 Week (^IRX)  Treasury Yield 10 Years (^TNX)  \\\n0                          3.11                           5.732   \n1                          3.14                           5.795   \n2                          3.11                           5.783   \n3                          3.11                           5.778   \n4                          3.11                           5.783   \n\n   Treasury Yield 30 Years (^TYX)  \n0                           6.226  \n1                           6.286  \n2                           6.268  \n3                           6.263  \n4                           6.258  \n\n[5 rows x 33 columns]","content_type":"text/plain"}}}],"identifier":"7ulhog5-qj4v-output","html_id":"id-7ulhog5-qj4v-output","key":"vokH6w69R6"}],"identifier":"7ulhog5-qj4v","label":"7ULhOg5-qj4v","html_id":"id-7ulhog5-qj4v","key":"lJwNMrcvyP"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Fill the missing values","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GJnodZwI6l"}],"identifier":"fill-the-missing-values","label":"Fill the missing values","html_id":"fill-the-missing-values","implicit":true,"key":"apo2bKgMs8"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"use ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"echjwUoWzS"},{"type":"inlineCode","value":"ffill","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XvbWsX7YSz"},{"type":"text","value":" to fill the data from previous days if it is missing.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"naUqH8Qd7O"}],"key":"rwR7wQaOL6"}],"key":"OYAosyTmkN"},{"type":"block","kind":"notebook-code","data":{"colab":{"base_uri":"https://localhost:8080/"},"id":"4lw53w6Qa6cm","outputId":"fa7fc273-627d-4355-995f-78a27705f3f6"},"children":[{"type":"code","lang":"python","executable":true,"value":"df = df1[['Date', 'S&P500 (^GSPC)']]\nif 'S&P500 (^GSPC)' in df.columns:\n    df = df.rename(columns={'S&P500 (^GSPC)': 'SP500'})\ndf.head(5)\n\nif 'Date' in df.columns:\n    df.set_index('Date', inplace=True)\n    d_range = pd.date_range(start=df.index.min(), end=df.index.max())\n    df.reindex(d_range)\n    df.ffill(inplace=True)\n    df = df.reset_index()\n    df = df.rename(columns={'index': 'Date'})\n\nmissing_dates_df = df[df.isnull().any(axis=1)]\nprint(f\"{missing_dates_df.size}, {df.size}, {len(df)}\")","identifier":"4lw53w6qa6cm-code","enumerator":"7","html_id":"id-4lw53w6qa6cm-code","key":"dnBeiGbCUC"},{"type":"output","id":"9nij0efWmZUVXm3kAMc2g","data":[{"name":"stdout","output_type":"stream","text":"0, 15508, 7754\n"}],"identifier":"4lw53w6qa6cm-output","html_id":"id-4lw53w6qa6cm-output","key":"WecWze3EVD"}],"identifier":"4lw53w6qa6cm","label":"4lw53w6Qa6cm","html_id":"id-4lw53w6qa6cm","key":"zrB0atQFsg"},{"type":"block","kind":"notebook-code","data":{"colab":{"base_uri":"https://localhost:8080/","height":53},"id":"mqZ-zYCNpiF9","outputId":"f425c950-d4d5-4ce8-b63b-3c79149890a2"},"children":[{"type":"code","lang":"python","executable":true,"value":"missing_dates_df.size\nmissing_dates_df.head(5)","identifier":"mqz-zycnpif9-code","enumerator":"8","html_id":"mqz-zycnpif9-code","key":"Ghwlpv6l1d"},{"type":"output","id":"OkVW23U6jjhgVVljXQc8w","data":[{"output_type":"execute_result","execution_count":29,"metadata":{},"data":{"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Date</th>\n      <th>SP500</th>\n    </tr>\n  </thead>\n  <tbody>\n  </tbody>\n</table>\n</div>","content_type":"text/html"},"text/plain":{"content":"Empty DataFrame\nColumns: [Date, SP500]\nIndex: []","content_type":"text/plain"}}}],"identifier":"mqz-zycnpif9-output","html_id":"mqz-zycnpif9-output","key":"lo9sQyoRHi"}],"identifier":"mqz-zycnpif9","label":"mqZ-zYCNpiF9","html_id":"mqz-zycnpif9","key":"S32u1elIvU"},{"type":"block","kind":"notebook-code","data":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ph3B9u7Ce5nI","outputId":"ca45b8bd-5cce-44f0-8fac-c626bd7baf30"},"children":[{"type":"code","lang":"python","executable":true,"value":"# df['day'] = pd.to_datetime(df['Date']).dt.day\n# df['month'] = pd.to_datetime(df['Date']).dt.month\n# df['year'] = pd.to_datetime(df['Date']).dt.year\n\ndf['weekday'] = pd.to_datetime(df['Date']).dt.weekday\ndf['max'] = df['SP500'].expanding().max()\ndf['r7_max'] = df['SP500'].rolling(window=7).max()\ndf['r30_max'] = df['SP500'].rolling(window=30).max()\n\nprint((df['r7_max']*0.9>df['SP500']).sum())\nprint((df['r30_max']==df['SP500']).sum())","identifier":"ph3b9u7ce5ni-code","enumerator":"9","html_id":"ph3b9u7ce5ni-code","key":"rDclpLw2Ow"},{"type":"output","id":"GJNSAe3btm12VXy4GVDGo","data":[{"name":"stdout","output_type":"stream","text":"39\n1367\n"}],"identifier":"ph3b9u7ce5ni-output","html_id":"ph3b9u7ce5ni-output","key":"fDteAb8U0d"}],"identifier":"ph3b9u7ce5ni","label":"ph3B9u7Ce5nI","html_id":"ph3b9u7ce5ni","key":"HshFyazl1i"},{"type":"block","kind":"notebook-code","data":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"id":"GXgCHdNQbKLM","outputId":"d3d3e50c-0c70-401d-c0b4-42c9c411040c"},"children":[{"type":"code","lang":"python","executable":true,"value":"df.query('r7_max*0.9>SP500')","identifier":"gxgchdnqbklm-code","enumerator":"10","html_id":"gxgchdnqbklm-code","key":"jjEuhPBXxz"},{"type":"output","id":"vO0xOxtBIixsGr1SvLO3D","data":[{"output_type":"execute_result","execution_count":31,"metadata":{},"data":{"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Date</th>\n      <th>SP500</th>\n      <th>weekday</th>\n      <th>max</th>\n      <th>r7_max</th>\n      <th>r30_max</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>1228</th>\n      <td>1998-08-31</td>\n      <td>957.280029</td>\n      <td>0</td>\n      <td>1186.750000</td>\n      <td>1092.849976</td>\n      <td>1165.069946</td>\n    </tr>\n    <tr>\n      <th>1649</th>\n      <td>2000-04-14</td>\n      <td>1356.560059</td>\n      <td>4</td>\n      <td>1527.459961</td>\n      <td>1516.349976</td>\n      <td>1527.459961</td>\n    </tr>\n    <tr>\n      <th>2020</th>\n      <td>2001-09-21</td>\n      <td>965.799988</td>\n      <td>4</td>\n      <td>1527.459961</td>\n      <td>1092.540039</td>\n      <td>1191.290039</td>\n    </tr>\n    <tr>\n      <th>2233</th>\n      <td>2002-07-22</td>\n      <td>819.849976</td>\n      <td>0</td>\n      <td>1527.459961</td>\n      <td>921.390015</td>\n      <td>1037.140015</td>\n    </tr>\n    <tr>\n      <th>2234</th>\n      <td>2002-07-23</td>\n      <td>797.700012</td>\n      <td>1</td>\n      <td>1527.459961</td>\n      <td>917.929993</td>\n      <td>1037.140015</td>\n    </tr>\n    <tr>\n      <th>3835</th>\n      <td>2008-09-29</td>\n      <td>1106.420044</td>\n      <td>0</td>\n      <td>1565.150024</td>\n      <td>1255.079956</td>\n      <td>1300.680054</td>\n    </tr>\n    <tr>\n      <th>3840</th>\n      <td>2008-10-06</td>\n      <td>1056.890015</td>\n      <td>0</td>\n      <td>1565.150024</td>\n      <td>1213.270020</td>\n      <td>1300.680054</td>\n    </tr>\n    <tr>\n      <th>3841</th>\n      <td>2008-10-07</td>\n      <td>996.229980</td>\n      <td>1</td>\n      <td>1565.150024</td>\n      <td>1166.359985</td>\n      <td>1300.680054</td>\n    </tr>\n    <tr>\n      <th>3842</th>\n      <td>2008-10-08</td>\n      <td>984.940002</td>\n      <td>2</td>\n      <td>1565.150024</td>\n      <td>1166.359985</td>\n      <td>1300.680054</td>\n    </tr>\n    <tr>\n      <th>3843</th>\n      <td>2008-10-09</td>\n      <td>909.919983</td>\n      <td>3</td>\n      <td>1565.150024</td>\n      <td>1161.060059</td>\n      <td>1282.829956</td>\n    </tr>\n    <tr>\n      <th>3844</th>\n      <td>2008-10-10</td>\n      <td>899.219971</td>\n      <td>4</td>\n      <td>1565.150024</td>\n      <td>1114.280029</td>\n      <td>1282.829956</td>\n    </tr>\n    <tr>\n      <th>3852</th>\n      <td>2008-10-22</td>\n      <td>896.780029</td>\n      <td>2</td>\n      <td>1565.150024</td>\n      <td>998.010010</td>\n      <td>1255.079956</td>\n    </tr>\n    <tr>\n      <th>3854</th>\n      <td>2008-10-24</td>\n      <td>876.770020</td>\n      <td>4</td>\n      <td>1565.150024</td>\n      <td>985.400024</td>\n      <td>1255.079956</td>\n    </tr>\n    <tr>\n      <th>3855</th>\n      <td>2008-10-27</td>\n      <td>848.919983</td>\n      <td>0</td>\n      <td>1565.150024</td>\n      <td>985.400024</td>\n      <td>1255.079956</td>\n    </tr>\n    <tr>\n      <th>3863</th>\n      <td>2008-11-06</td>\n      <td>904.880005</td>\n      <td>3</td>\n      <td>1565.150024</td>\n      <td>1005.750000</td>\n      <td>1213.270020</td>\n    </tr>\n    <tr>\n      <th>3866</th>\n      <td>2008-11-11</td>\n      <td>898.950012</td>\n      <td>1</td>\n      <td>1565.150024</td>\n      <td>1005.750000</td>\n      <td>1161.060059</td>\n    </tr>\n    <tr>\n      <th>3867</th>\n      <td>2008-11-12</td>\n      <td>852.299988</td>\n      <td>2</td>\n      <td>1565.150024</td>\n      <td>1005.750000</td>\n      <td>1114.280029</td>\n    </tr>\n    <tr>\n      <th>3872</th>\n      <td>2008-11-19</td>\n      <td>806.580017</td>\n      <td>2</td>\n      <td>1565.150024</td>\n      <td>911.289978</td>\n      <td>1005.750000</td>\n    </tr>\n    <tr>\n      <th>3873</th>\n      <td>2008-11-20</td>\n      <td>752.440002</td>\n      <td>3</td>\n      <td>1565.150024</td>\n      <td>911.289978</td>\n      <td>1005.750000</td>\n    </tr>\n    <tr>\n      <th>3874</th>\n      <td>2008-11-21</td>\n      <td>800.030029</td>\n      <td>4</td>\n      <td>1565.150024</td>\n      <td>911.289978</td>\n      <td>1005.750000</td>\n    </tr>\n    <tr>\n      <th>3938</th>\n      <td>2009-02-23</td>\n      <td>743.330017</td>\n      <td>0</td>\n      <td>1565.150024</td>\n      <td>826.840027</td>\n      <td>874.090027</td>\n    </tr>\n    <tr>\n      <th>3946</th>\n      <td>2009-03-05</td>\n      <td>682.549988</td>\n      <td>3</td>\n      <td>1565.150024</td>\n      <td>764.900024</td>\n      <td>874.090027</td>\n    </tr>\n    <tr>\n      <th>4573</th>\n      <td>2011-08-08</td>\n      <td>1119.459961</td>\n      <td>0</td>\n      <td>1565.150024</td>\n      <td>1292.280029</td>\n      <td>1353.219971</td>\n    </tr>\n    <tr>\n      <th>4575</th>\n      <td>2011-08-10</td>\n      <td>1120.760010</td>\n      <td>2</td>\n      <td>1565.150024</td>\n      <td>1260.339966</td>\n      <td>1353.219971</td>\n    </tr>\n    <tr>\n      <th>5617</th>\n      <td>2015-08-25</td>\n      <td>1867.609985</td>\n      <td>1</td>\n      <td>2130.820068</td>\n      <td>2102.439941</td>\n      <td>2128.280029</td>\n    </tr>\n    <tr>\n      <th>6781</th>\n      <td>2020-02-27</td>\n      <td>2978.760010</td>\n      <td>3</td>\n      <td>3386.149902</td>\n      <td>3386.149902</td>\n      <td>3386.149902</td>\n    </tr>\n    <tr>\n      <th>6782</th>\n      <td>2020-02-28</td>\n      <td>2954.219971</td>\n      <td>4</td>\n      <td>3386.149902</td>\n      <td>3373.229980</td>\n      <td>3386.149902</td>\n    </tr>\n    <tr>\n      <th>6788</th>\n      <td>2020-03-09</td>\n      <td>2746.560059</td>\n      <td>0</td>\n      <td>3386.149902</td>\n      <td>3130.120117</td>\n      <td>3386.149902</td>\n    </tr>\n    <tr>\n      <th>6790</th>\n      <td>2020-03-11</td>\n      <td>2741.379883</td>\n      <td>2</td>\n      <td>3386.149902</td>\n      <td>3130.120117</td>\n      <td>3386.149902</td>\n    </tr>\n    <tr>\n      <th>6791</th>\n      <td>2020-03-12</td>\n      <td>2480.639893</td>\n      <td>3</td>\n      <td>3386.149902</td>\n      <td>3130.120117</td>\n      <td>3386.149902</td>\n    </tr>\n    <tr>\n      <th>6792</th>\n      <td>2020-03-13</td>\n      <td>2711.020020</td>\n      <td>4</td>\n      <td>3386.149902</td>\n      <td>3023.939941</td>\n      <td>3386.149902</td>\n    </tr>\n    <tr>\n      <th>6793</th>\n      <td>2020-03-16</td>\n      <td>2386.129883</td>\n      <td>0</td>\n      <td>3386.149902</td>\n      <td>2972.370117</td>\n      <td>3386.149902</td>\n    </tr>\n    <tr>\n      <th>6794</th>\n      <td>2020-03-17</td>\n      <td>2529.189941</td>\n      <td>1</td>\n      <td>3386.149902</td>\n      <td>2882.229980</td>\n      <td>3386.149902</td>\n    </tr>\n    <tr>\n      <th>6795</th>\n      <td>2020-03-18</td>\n      <td>2398.100098</td>\n      <td>2</td>\n      <td>3386.149902</td>\n      <td>2882.229980</td>\n      <td>3386.149902</td>\n    </tr>\n    <tr>\n      <th>6796</th>\n      <td>2020-03-19</td>\n      <td>2409.389893</td>\n      <td>3</td>\n      <td>3386.149902</td>\n      <td>2741.379883</td>\n      <td>3386.149902</td>\n    </tr>\n    <tr>\n      <th>6797</th>\n      <td>2020-03-20</td>\n      <td>2304.919922</td>\n      <td>4</td>\n      <td>3386.149902</td>\n      <td>2711.020020</td>\n      <td>3386.149902</td>\n    </tr>\n    <tr>\n      <th>6798</th>\n      <td>2020-03-23</td>\n      <td>2237.399902</td>\n      <td>0</td>\n      <td>3386.149902</td>\n      <td>2711.020020</td>\n      <td>3386.149902</td>\n    </tr>\n    <tr>\n      <th>7374</th>\n      <td>2022-06-14</td>\n      <td>3735.479980</td>\n      <td>1</td>\n      <td>4796.560059</td>\n      <td>4160.680176</td>\n      <td>4300.169922</td>\n    </tr>\n    <tr>\n      <th>7376</th>\n      <td>2022-06-16</td>\n      <td>3666.770020</td>\n      <td>3</td>\n      <td>4796.560059</td>\n      <td>4115.770020</td>\n      <td>4176.819824</td>\n    </tr>\n  </tbody>\n</table>\n</div>","content_type":"text/html"},"text/plain":{"content":"            Date        SP500  weekday          max       r7_max      r30_max\n1228  1998-08-31   957.280029        0  1186.750000  1092.849976  1165.069946\n1649  2000-04-14  1356.560059        4  1527.459961  1516.349976  1527.459961\n2020  2001-09-21   965.799988        4  1527.459961  1092.540039  1191.290039\n2233  2002-07-22   819.849976        0  1527.459961   921.390015  1037.140015\n2234  2002-07-23   797.700012        1  1527.459961   917.929993  1037.140015\n3835  2008-09-29  1106.420044        0  1565.150024  1255.079956  1300.680054\n3840  2008-10-06  1056.890015        0  1565.150024  1213.270020  1300.680054\n3841  2008-10-07   996.229980        1  1565.150024  1166.359985  1300.680054\n3842  2008-10-08   984.940002        2  1565.150024  1166.359985  1300.680054\n3843  2008-10-09   909.919983        3  1565.150024  1161.060059  1282.829956\n3844  2008-10-10   899.219971        4  1565.150024  1114.280029  1282.829956\n3852  2008-10-22   896.780029        2  1565.150024   998.010010  1255.079956\n3854  2008-10-24   876.770020        4  1565.150024   985.400024  1255.079956\n3855  2008-10-27   848.919983        0  1565.150024   985.400024  1255.079956\n3863  2008-11-06   904.880005        3  1565.150024  1005.750000  1213.270020\n3866  2008-11-11   898.950012        1  1565.150024  1005.750000  1161.060059\n3867  2008-11-12   852.299988        2  1565.150024  1005.750000  1114.280029\n3872  2008-11-19   806.580017        2  1565.150024   911.289978  1005.750000\n3873  2008-11-20   752.440002        3  1565.150024   911.289978  1005.750000\n3874  2008-11-21   800.030029        4  1565.150024   911.289978  1005.750000\n3938  2009-02-23   743.330017        0  1565.150024   826.840027   874.090027\n3946  2009-03-05   682.549988        3  1565.150024   764.900024   874.090027\n4573  2011-08-08  1119.459961        0  1565.150024  1292.280029  1353.219971\n4575  2011-08-10  1120.760010        2  1565.150024  1260.339966  1353.219971\n5617  2015-08-25  1867.609985        1  2130.820068  2102.439941  2128.280029\n6781  2020-02-27  2978.760010        3  3386.149902  3386.149902  3386.149902\n6782  2020-02-28  2954.219971        4  3386.149902  3373.229980  3386.149902\n6788  2020-03-09  2746.560059        0  3386.149902  3130.120117  3386.149902\n6790  2020-03-11  2741.379883        2  3386.149902  3130.120117  3386.149902\n6791  2020-03-12  2480.639893        3  3386.149902  3130.120117  3386.149902\n6792  2020-03-13  2711.020020        4  3386.149902  3023.939941  3386.149902\n6793  2020-03-16  2386.129883        0  3386.149902  2972.370117  3386.149902\n6794  2020-03-17  2529.189941        1  3386.149902  2882.229980  3386.149902\n6795  2020-03-18  2398.100098        2  3386.149902  2882.229980  3386.149902\n6796  2020-03-19  2409.389893        3  3386.149902  2741.379883  3386.149902\n6797  2020-03-20  2304.919922        4  3386.149902  2711.020020  3386.149902\n6798  2020-03-23  2237.399902        0  3386.149902  2711.020020  3386.149902\n7374  2022-06-14  3735.479980        1  4796.560059  4160.680176  4300.169922\n7376  2022-06-16  3666.770020        3  4796.560059  4115.770020  4176.819824","content_type":"text/plain"}}}],"identifier":"gxgchdnqbklm-output","html_id":"gxgchdnqbklm-output","key":"MDeV97kUZN"}],"identifier":"gxgchdnqbklm","label":"GXgCHdNQbKLM","html_id":"gxgchdnqbklm","key":"TXXxsOb2PL"},{"type":"block","kind":"notebook-code","data":{"id":"fHuB6moUbMia"},"children":[{"type":"code","lang":"python","executable":true,"value":"from collections import namedtuple\n\nclass Asset:\n    def __init__(self, cash, stock):\n        self.cash = cash\n        self.stock = stock\n        self.total = cash + stock\n\n    def __add__(self, other):\n        return Asset(self.cash + other.cash, self.stock + other.stock)\n\n\nCurrentAsset = namedtuple('CurrentAsset', ['cash', 'stock'])\nInputs = namedtuple('Inputs', ['values', 'weekday', 'amount'])\nOutputs = namedtuple('Outputs', ['final', 'history'])\n\ndef keep_cash(inputs):\n    values, weekday, amount = inputs\n    pa = CurrentAsset(cash=0, stock=0)\n    final = CurrentAsset(cash=0,stock=0)\n    history = []\n    for d, v in zip(weekday, values):\n        final = CurrentAsset(cash=final.cash+amount, stock=0)\n        history += final\n    return Outputs(final=final, history=history)\n\ndef dollar_avg(inputs):\n    values, weekday, amount = inputs\n    pa = CurrentAsset(cash=0, stock=0)\n    final = CurrentAsset(cash=0,stock=0)\n    history = []\n    for d, v in zip(weekday, values):\n        final = CurrentAsset(cash=0, stock=final.stock + (amount/v))\n        history += final\n    return Outputs(final=final, history=history)\n\n\nv = dollar_avg(Inputs(values=df.SP500.to_list(), weekday=df.weekday.to_list(), amount=100))\n\n","identifier":"fhub6moubmia-code","enumerator":"11","html_id":"fhub6moubmia-code","key":"QVt9rOvrV9"},{"type":"output","id":"IfhGT0QQLKhtanSnI_DF8","data":[],"identifier":"fhub6moubmia-output","html_id":"fhub6moubmia-output","key":"vitICGQYKV"}],"identifier":"fhub6moubmia","label":"fHuB6moUbMia","html_id":"fhub6moubmia","key":"crcO0P6eoh"},{"type":"block","kind":"notebook-code","data":{"colab":{"base_uri":"https://localhost:8080/"},"id":"5C_U9OVMyjVe","outputId":"d3d1774f-f028-426c-af80-32447b24d996"},"children":[{"type":"code","lang":"python","executable":true,"value":"print(v.final)","identifier":"5c_u9ovmyjve-code","enumerator":"12","html_id":"id-5c-u9ovmyjve-code","key":"MzVMaMqDTl"},{"type":"output","id":"HswjKrlBsU4AY5ukV00-T","data":[{"name":"stdout","output_type":"stream","text":"CurrentAsset(cash=0, stock=616.584752905432)\n"}],"identifier":"5c_u9ovmyjve-output","html_id":"id-5c-u9ovmyjve-output","key":"mJVgKdVFij"}],"identifier":"5c_u9ovmyjve","label":"5C_U9OVMyjVe","html_id":"id-5c-u9ovmyjve","key":"kJXLnyJBfI"}],"key":"MjrFdKQ44b"},"references":{"cite":{"order":[],"data":{}}}}